diff --git a/dist/vite-plugin-astro-image.js b/dist/vite-plugin-astro-image.js
index 5f199c8b7c5b8b367d67636f7d95c7943eec95e7..7c6f680b29b59927a5844b99b054c0997cc210b7 100644
--- a/dist/vite-plugin-astro-image.js
+++ b/dist/vite-plugin-astro-image.js
@@ -39,9 +39,7 @@ function createPlugin(config, options) {
         });
         meta.src = `__ASTRO_IMAGE_ASSET__${handle}__`;
       } else {
-        const relId = path.relative(fileURLToPath(config.srcDir), id);
-        meta.src = join("/@astroimage", relId);
-        meta.src = slash(meta.src);
+        meta.src = "/@astroimage" + url.pathname;
       }
       return `export default ${JSON.stringify(meta)}`;
     },
@@ -49,8 +47,7 @@ function createPlugin(config, options) {
       server.middlewares.use(async (req, res, next) => {
         var _a;
         if ((_a = req.url) == null ? void 0 : _a.startsWith("/@astroimage/")) {
-          const [, id] = req.url.split("/@astroimage/");
-          const url = new URL(id, config.srcDir);
+          const url = new URL(req.url.slice('/@astroimage'.length), 'file:');
           const file = await fs.readFile(url);
           const meta = await metadata(url);
           if (!meta) {